C51 COMPILER V9.60.7.0   UART                                                              02/01/2026 18:50:33 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\Objects\Uart.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Uart.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\Uart
                    -.lst) OBJECT(.\Objects\Uart.obj)

line level    source

   1          #include <stc15f2k60s2.h>
   2          #include "PCF8591.h"
   3          
   4          //电阻电压存储数组
   5          unsigned char RB2_send[10];
   6          //电阻电压转化数组
   7          unsigned char RB2_dat[] = {'0','1','2','3','4','5','6','7','8','9'};
   8          
   9          void Uart_Init(void)    //9600bps@12.000MHz
  10          {
  11   1              SCON = 0x50;            //8位数据,可变波特率
  12   1              AUXR |= 0x40;           //定时器时钟1T模式
  13   1              AUXR &= 0xFE;           //串口1选择定时器1为波特率发生器
  14   1              TMOD &= 0x0F;           //设置定时器模式
  15   1              TL1 = 0xC7;                     //设置定时初始值
  16   1              TH1 = 0xFE;                     //设置定时初始值
  17   1              ET1 = 0;                        //禁止定时器中断
  18   1              TR1 = 1;                        //定时器1开始计时
  19   1      }
  20          
  21          //串口发送字符函数
  22          void uart_sendstring(unsigned char *str){
  23   1              unsigned char *dat;
  24   1              dat = str;
  25   1              while(*dat != '\0'){
  26   2                      SBUF = *dat;
  27   2                      while(TI == 0);
  28   2                      TI = 0;
  29   2                      dat++;
  30   2              }
  31   1      }
  32          
  33          //接收电压转化函数
  34          void Send_RB2(){
  35   1              float RB2 = RB2_Value(); 
  36   1              unsigned int RB2_value = (unsigned int)(RB2 * 500);
  37   1              if(RB2_value >= 100){
  38   2                      RB2_send[0] = 'U';
  39   2                      RB2_send[1] = ':';
  40   2                      RB2_send[2] = RB2_dat[RB2_value / 100];
  41   2                      RB2_send[3] = '.';
  42   2                      RB2_send[4] = RB2_dat[RB2_value % 100 / 10];
  43   2                      RB2_send[5] = RB2_dat[RB2_value % 10];
  44   2                      RB2_send[6] = 'V';
  45   2                      RB2_send[7] = '\r';
  46   2                      RB2_send[8] = '\n';
  47   2                      RB2_send[9] = '\0';
  48   2              }
  49   1              if(RB2_value >= 10 && RB2_value < 100){
  50   2                      RB2_send[0] = 'U';
  51   2                      RB2_send[1] = ':';
  52   2                      RB2_send[2] = RB2_dat[0];
  53   2                      RB2_send[3] = '.';
  54   2                      RB2_send[4] = RB2_dat[RB2_value / 10];
C51 COMPILER V9.60.7.0   UART                                                              02/01/2026 18:50:33 PAGE 2   

  55   2                      RB2_send[5] = RB2_dat[RB2_value % 10];
  56   2                      RB2_send[6] = 'V';
  57   2                      RB2_send[7] = '\r';
  58   2                      RB2_send[8] = '\n';
  59   2                      RB2_send[9] = '\0';
  60   2              }
  61   1              if(RB2_value >= 0 && RB2_value < 10){
  62   2                      RB2_send[0] = 'U';
  63   2                      RB2_send[1] = ':';
  64   2                      RB2_send[2] = RB2_dat[0];
  65   2                      RB2_send[3] = '.';
  66   2                      RB2_send[4] = RB2_dat[0];
  67   2                      RB2_send[5] = RB2_dat[RB2_value % 10];
  68   2                      RB2_send[6] = 'V';
  69   2                      RB2_send[7] = '\r';
  70   2                      RB2_send[8] = '\n';
  71   2                      RB2_send[9] = '\0';
  72   2              }
  73   1              uart_sendstring(RB2_send);
  74   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    319    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     20       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
