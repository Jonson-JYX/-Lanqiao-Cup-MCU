C51 COMPILER V9.60.7.0   LED_DISPLAY                                                       01/27/2026 15:21:29 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LED_DISPLAY
OBJECT MODULE PLACED IN .\Objects\LED_Display.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE LED_Display.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listin
                    -gs\LED_Display.lst) OBJECT(.\Objects\LED_Display.obj)

line level    source

   1          #include <stc15f2k60s2.h>
   2          #include "Common.h"
   3          #include "Delay.h"
   4          #include "PCF8591.h"
   5          
   6          code unsigned char SEG_Table[] = {
   7                  0xC0,   //0
   8                  0xF9,   //1
   9                  0xA4,   //2
  10                  0xB0,   //3
  11                  0x99,   //4
  12                  0x92,   //5
  13                  0x82,   //6
  14                  0xF8,   //7
  15                  0x80,   //8
  16                  0x90,   //9
  17                  0xFF    //全灭
  18          };
  19          
  20          //记录当前电压
  21          unsigned char dat_value = 0;
  22          //记录最大电压
  23          unsigned char dat_max = 0;
  24          //记录最小电压
  25          unsigned char dat_min = 100;
  26          
  27          //临时存储数组
  28          unsigned char dat_value_arr[] = {10,10,10,10,10,10,10,10};
  29          //电压显示数组
  30          unsigned char dat_show_arr[] = {10,10,10,10,10,10,10,10};
  31          
  32          //电压转化函数
  33          void Lighting_Change(){
  34   1              float dat = Lighting_Value();
  35   1              unsigned char i;
  36   1              unsigned int value = (unsigned int)(dat * 50.0);
  37   1              if(value > dat_max){
  38   2                      dat_max = value;
  39   2              }
  40   1              if(value < dat_min){
  41   2                      dat_min = value;
  42   2              }
  43   1              
  44   1              if(value >= 10){
  45   2                      dat_value_arr[0] = value / 10;
  46   2                      dat_value_arr[1] = value % 10;
  47   2              }
  48   1              else{
  49   2                      dat_value_arr[0] = 0;
  50   2                      dat_value_arr[1] = value % 10;
  51   2              }
  52   1              
  53   1              if(dat_min >= 10){
  54   2                      dat_value_arr[3] = dat_min / 10;
C51 COMPILER V9.60.7.0   LED_DISPLAY                                                       01/27/2026 15:21:29 PAGE 2   

  55   2                      dat_value_arr[4] = dat_min % 10;
  56   2              }
  57   1              else{
  58   2                      dat_value_arr[3] = 0;
  59   2                      dat_value_arr[4] = dat_min % 10;
  60   2              }
  61   1              
  62   1              if(dat_max >= 10){
  63   2                      dat_value_arr[6] = dat_max / 10;
  64   2                      dat_value_arr[7] = dat_max % 10;
  65   2              }
  66   1              else{
  67   2                      dat_value_arr[6] = 0;
  68   2                      dat_value_arr[7] = dat_max % 10;
  69   2              }
  70   1              
  71   1              for(i = 0;i < 8;i++){
  72   2                      dat_show_arr[i] = dat_value_arr[i];
  73   2              }
  74   1      }
  75          //数码管显示函数
  76          void LED_Display_Show(){
  77   1              unsigned char i;
  78   1              unsigned char dat;
  79   1              unsigned char com = 0;
  80   1              
  81   1              for(i = 0;i < 8;i++){
  82   2                      SEG(0xFF);
  83   2                      COM(0xFF);
  84   2                      COM(1<<com);
  85   2                      dat = SEG_Table[dat_show_arr[i]];
  86   2                      if(i == 0 || i == 3 || i == 6){
  87   3                              dat = dat & 0x7F;
  88   3                      }
  89   2                      SEG(dat);
  90   2                      com++;
  91   2                      Delay50us();
  92   2              }
  93   1              com = 0;
  94   1              SEG(0xFF);
  95   1              COM(0xFF);
  96   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    325    ----
   CONSTANT SIZE    =     11    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     19       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
